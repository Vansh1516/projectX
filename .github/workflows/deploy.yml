name: Deploy to Home Lab

on:
  push:
    branches: [ "main", "master" ]  # Watches BOTH to be safe
  workflow_dispatch:
jobs:
  build-and-deploy:
    runs-on: self-hosted

    steps:
    - name: Checkout Code
      uses: actions/checkout@v3

    - name: Install Dependencies
      run: npm install

    - name: Build Project
      run: npm run build

    - name: Move Files to Web Root
      run: |
        echo "ğŸš¨ Deleting old files..."
        rm -rf /var/www/html/*
        
        echo "ğŸ“‚ Copying new files..."
        cp -r dist/. /var/www/html/
        
        echo "ğŸ” Verifying new content..."
        ls -la /var/www/html/